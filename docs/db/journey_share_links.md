# journey_share_links

A user can generate a link to a signed-out page where a journey can be
viewed within the app. The extent to which the user can actually take the
journey depends on the specific journey and the user who created the link.

Unlike with touches, which are generated by the system and thus are optimized
for bulk creation, it's expected these use a basic rejection sampling approach
directly against the db.

SEE ALSO: [journeys](./journeys.md)
SEE ALSO: [user_touches](./user_touches.md)
SEE ALSO: [user_touch_links](./user_touch_links.md)

## Fields

- `id (integer primary key)`: Internal row identifier
- `uid (text unique not null)`: Primary stable external identifier. Uses
  the [uid prefix](../uid_prefixes.md) `jsl`
- `code (text unique not null)`: The short code that links to the journey
- `user_id (integer null references users(id) on delete set null)`: the user
  who created the link, if they still exist
- `journey_id (integer not null references journeys(id) on delete cascade)`:
  the journey that is linked to
- `created_at (real not null)`: when this link was created, in seconds since
  the unix epoch

## Schema

```sql
CREATE TABLE journey_share_links (
    id INTEGER PRIMARY KEY,
    uid TEXT UNIQUE NOT NULL,
    code TEXT UNIQUE NOT NULL,
    user_id INTEGER NULL REFERENCES users(id) ON DELETE SET NULL,
    journey_id INTEGER NOT NULL REFERENCES journeys(id) ON DELETE CASCADE,
    created_at REAL NOT NULL
);

/* Foreign key */
CREATE INDEX journey_share_links_user_idx ON journey_share_links(user_id);

/* Foreign key */
CREATE INDEX journey_share_links_journey_idx ON journey_share_links(journey_id);
```
